{% extends 'core/base.html' %}
{% load static %}

{% block title %}Minha Conta{% endblock %}

{% block content %}

<section class="bg-marinho-escuro text-white">
    <div class="container mx-auto px-6 py-20 md:py-28 text-center">
        <h1 class="font-serif text-5xl md:text-7xl font-bold">
            Minha Conta
        </h1>
        <p class="mt-4 text-lg md:text-xl max-w-2xl mx-auto text-cinza-claro/80">
            Olá, {{ user.first_name|default:user.email }}. Aqui você pode gerenciar seus dados.
        </p>
    </div>
</section>

<section class="py-20 bg-cinza-fundo">
    <div class="container mx-auto px-6">
        
        <div class="max-w-2xl mx-auto bg-white p-8 md:p-12 rounded-lg shadow-xl">
            
            {% if messages %}
                {% for message in messages %}
                    {% if 'profile_update' in message.tags or 'password_update' in message.tags %}
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6" role="alert">
                            <span class="block sm:inline">{{ message }}</span>
                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}

            <div class="mb-6 border-b border-gray-200">
                <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                    <a href="#" class="border-ouro text-marinho whitespace-nowrap py-3 px-1 border-b-2 font-medium text-lg" aria-current="page">
                        Meu Perfil
                    </a>
                    <a href="{% url 'account_change_password' %}" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-lg">
                        Alterar Senha
                    </a>
                </nav>
            </div>

            <h2 class="font-serif text-3xl text-marinho font-bold mb-6">Seus Dados</h2>
            
            <form method="POST" class="space-y-6" action="{% url 'core:minha_conta' %}">
                {% csrf_token %}
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="{{ user_form.first_name.id_for_label }}" class="block text-sm font-medium text-graphite mb-2">Nome</label>
                        <input type="text" name="{{ user_form.first_name.name }}" id="{{ user_form.first_name.id_for_label }}"
                               value="{{ user_form.first_name.value|default:'' }}"
                               class="w-full p-3 text-sm text-graphite bg-white border border-gray-400 rounded-lg focus:outline-none focus:border-ouro focus:ring-2 focus:ring-ouro/50">
                        {% for error in user_form.first_name.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ error }}</p>
                        {% endfor %}
                    </div>
                    <div>
                        <label for="{{ user_form.last_name.id_for_label }}" class="block text-sm font-medium text-graphite mb-2">Sobrenome</label>
                        <input type="text" name="{{ user_form.last_name.name }}" id="{{ user_form.last_name.id_for_label }}"
                               value="{{ user_form.last_name.value|default:'' }}"
                               class="w-full p-3 text-sm text-graphite bg-white border border-gray-400 rounded-lg focus:outline-none focus:border-ouro focus:ring-2 focus:ring-ouro/50">
                        {% for error in user_form.last_name.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ error }}</p>
                        {% endfor %}
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-graphite mb-2">Email (Login)</label>
                    <input type="email" value="{{ user.email }}"
                           class="w-full p-3 text-sm text-gray-500 bg-cinza-fundo border border-gray-300 rounded-lg"
                           readonly disabled>
                    <p class="text-xs text-gray-500 mt-1">
                        Para alterar seu email, vá em 
                        <a href="{% url 'account_email' %}" class="text-marinho underline">Gerenciar Emails</a>.
                    </p>
                </div>

                <div>
                    <label for="{{ profile_form.telefone.id_for_label }}" class="block text-sm font-medium text-graphite mb-2">Telefone / WhatsApp</label>
                    <input type="text" name="{{ profile_form.telefone.name }}" id="{{ profile_form.telefone.id_for_label }}"
                           value="{{ profile_form.telefone.value|default:'' }}"
                           placeholder="(Ex: 62988776655)"
                           class="w-full p-3 text-sm text-graphite bg-white border border-gray-400 rounded-lg focus:outline-none focus:border-ouro focus:ring-2 focus:ring-ouro/50">
                    {% for error in profile_form.telefone.errors %}
                        <p class="text-red-600 text-sm mt-1">{{ error }}</p>
                    {% endfor %}
                </div>

                <div class="pt-4">
                    <button type="submit" 
                            class="flex items-center justify-center w-full bg-ouro text-white font-medium px-5 py-4 rounded-lg shadow-lg hover:bg-ouro/90 transition duration-300">
                        Salvar Alterações
                    </button>
                </div>
            </form>
            
            <div class="mt-10 border-t pt-6">
                <a href="{% url 'account_logout' %}" class="text-red-600 hover:text-red-800 transition duration-300">
                    Sair da conta (Logout)
                </a>
            </div>

        </div>

    </div>
</section>
{% endblock %}